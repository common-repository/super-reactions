"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}document.addEventListener("DOMContentLoaded",function(e){var i=document.getElementById("_wpnonce");function t(e){var t;document.querySelector(".srea-tab.active").classList.remove("active"),e.currentTarget.classList.add("active"),t=e.currentTarget.dataset.view,document.querySelector(".srea-view.active").classList.remove("active"),document.querySelector("#".concat(t)).classList.add("active")}function o(){var e=document.createElement("div");return e.className="srea-loader",e}function s(e,t){var n=document.createElement("div");return n.className=e?"srea-result-badge srea-badge-success":"srea-result-badge srea-badge-error",n.textContent=t,n}document.querySelectorAll(".srea-tab").forEach(function(e){e.addEventListener("click",t)}),new(function(){function e(){var t=this;_classCallCheck(this,e),this.modal=document.querySelector("#srea-settings-modal"),this.selectingOption="",this.modalFor="",document.querySelectorAll("[data-srea-option]").forEach(function(e){e.addEventListener("click",t.open.bind(t))}),document.querySelectorAll(".srea-remover").forEach(function(e){e.addEventListener("click",t.remove.bind(t))}),this.modal.querySelectorAll(".srea-setting-preview").forEach(function(e){e.addEventListener("click",t.select.bind(t))}),document.querySelector("#srea-modal-close-btn").addEventListener("click",this.close.bind(this))}return _createClass(e,[{key:"open",value:function(e){var t=e.currentTarget.dataset.sreaOption;this.selectingOption=t,this.modalFor=e.currentTarget,this.addTitle(t),this.modal.classList.add("visible"),this.calculatePosition(),window.addEventListener("resize",this.calculatePosition)}},{key:"capitalize",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"addTitle",value:function(e){document.getElementById("srea-modal-title-option-name").insertAdjacentText("beforeend",this.capitalize(e))}},{key:"close",value:function(){this.modal.classList.remove("visible");var e=document.getElementById("srea-modal-title-option-name");this.empty(e),this.selectingOption=null,this.modalFor=null}},{key:"calculatePosition",value:function(){var e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);this.modal.style.left="".concat((e+document.getElementById("adminmenuwrap").offsetWidth-this.modal.offsetWidth)/2,"px"),this.modal.style.top="".concat((t-this.modal.offsetHeight)/2,"px")}},{key:"select",value:function(e){var t=e.currentTarget.cloneNode(!0),n=this.modalFor.closest(".srea-template-selector").querySelector(".srea-selected-template-preview");this.empty(n),n.insertAdjacentElement("beforeend",t),this.modalFor.innerText="Change",this.enableBtn(this.modalFor.parentNode.querySelector(".srea-remover")),this.saveSettings(e)}},{key:"saveSettings",value:function(e){var n=o(),a=document.querySelector(".srea-view.active");a.insertAdjacentElement("afterBegin",n);var t=new FormData;t.append("action","srea_save_settings"),t.append("nonce",i.value),t.append("option",this.selectingOption),t.append("value",e.currentTarget.dataset.slug),this.close(),fetch(ajaxurl,{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){a.removeChild(n);var t=s(e.success,e.data.results);a.insertAdjacentElement("afterBegin",t),setTimeout(function(){a.removeChild(t)},500)})}},{key:"remove",value:function(e){var t=e.currentTarget.closest(".srea-template-selector").querySelector(".srea-selected-template-preview");this.empty(t),this.disableBtn(e.currentTarget);var n=o(),a=document.querySelector(".srea-view.active");a.insertAdjacentElement("afterBegin",n);var r=new FormData;r.append("action","srea_save_settings"),r.append("nonce",i.value),r.append("option",e.currentTarget.dataset.sreaOption),r.append("value",""),this.close(),fetch(ajaxurl,{method:"POST",body:r}).then(function(e){return e.json()}).then(function(e){a.removeChild(n);var t=s(e.success,e.data.results);a.insertAdjacentElement("afterBegin",t),setTimeout(function(){a.removeChild(t)},500)})}},{key:"disableBtn",value:function(e){e.setAttribute("disabled","disabled")}},{key:"enableBtn",value:function(e){e.removeAttribute("disabled")}},{key:"empty",value:function(e){e.innerHTML=null}}]),e}())});